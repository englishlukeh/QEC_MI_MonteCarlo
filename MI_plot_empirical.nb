(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13272,        357]
NotebookOptionsPosition[     12275,        333]
NotebookOutlinePosition[     12682,        349]
CellTagsIndexPosition[     12639,        346]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"First", " ", "we", " ", "curve"}], "-", 
     RowBox[{
     "fit", " ", "Pfail", " ", "as", " ", "a", " ", "function", " ", "of", 
      " ", "p", " ", "and", " ", "L"}]}], ",", " ", 
    RowBox[{"in", " ", "accordance", " ", "with", " ", 
     RowBox[{"(", "A1", ")"}], " ", "of", " ", "Watson", " ", "and", " ", 
     "Barrett", " ", 
     RowBox[{"(", "2014", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s", "=", 
     RowBox[{
      RowBox[{"Import", "[", "\"\<toric_code_raw.xlsx\>\"", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"sNames", "=", 
    RowBox[{"s", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"sData", "=", 
    RowBox[{"s", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"sData", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "1"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.899499466502308*^9, 3.899499468512377*^9}, {
   3.899499499112774*^9, 3.8994995111233034`*^9}, 3.899499782449025*^9, {
   3.8994998250666122`*^9, 3.899499862512542*^9}, {3.899500299960821*^9, 
   3.899500300079914*^9}, {3.8995005149205356`*^9, 3.899500543053174*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"949e8ed0-f90c-4246-b796-c57945627308"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"p\"\>", ",", "\<\"L\"\>", ",", "\<\"I\"\>", 
   ",", "\<\"deltaI\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.899499507933137*^9, 3.899499782684928*^9, {3.8994998303416348`*^9, 
   3.899499862852442*^9}, 3.8995002518186717`*^9, {3.8995002953668985`*^9, 
   3.8995003010026135`*^9}, 3.8995003776864605`*^9, 3.8995004193394213`*^9, {
   3.899500518245306*^9, 3.899500543349618*^9}},
 CellLabel->
  "Out[230]=",ExpressionUUID->"b44fd46e-0901-42ed-8aab-c327a1e2245a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.01`", ",", "1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.01`", ",", "3.`", ",", "0.006071142339286`", ",", 
     "1.0560102826176`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.01`", ",", "5.`", ",", "0.001013724435069`", ",", 
     "2.95575299799915`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.01`", ",", "7.`", ",", "0.000126092109969226`", ",", 
     "5.76163987199594`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.01`", ",", "9.`", ",", "0.0000296282385221396`", ",", 
     "0.0000105220436690139`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.01`", ",", "11.`", ",", "2.8645970405326`*^-6", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.02`", ",", "1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.02`", ",", "3.`", ",", "0.019469647069358`", ",", 
     "1.4276981602336`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.02`", ",", "5.`", ",", "0.006832772958479`", ",", 
     "4.16459118692126`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.02`", ",", "7.`", ",", "0.002775648309713`", ",", 
     "8.82013240263834`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.02`", ",", "9.`", ",", "0.000540756588824704`", ",", 
     "0.0000619164367308088`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.02`", ",", "11.`", ",", "0.000100915099402739`", ",", 
     "0.000029833054885455`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.03`", ",", "1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.03`", ",", "3.`", ",", "0.037054422594316`", ",", 
     "1.58609451262846`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.03`", ",", "5.`", ",", "0.020907038408738`", ",", 
     "4.73919006910684`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.03`", ",", "7.`", ",", "0.01213663252473`", ",", 
     "0.0000314319527822279`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.03`", ",", "9.`", ",", "0.005012853559266`", ",", 
     "0.0000334434346002047`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.03`", ",", "11.`", ",", "0.001511890594672`", ",", 
     "0.000100057060657408`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.04`", ",", "1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.04`", ",", "3.`", ",", "0.057304518316995`", ",", 
     "1.61760993674024`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.04`", ",", "5.`", ",", "0.04111009624871`", ",", 
     "5.1044900092238`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.04`", ",", "7.`", ",", "0.03928778653458`", ",", 
     "0.000088326920819343`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.04`", ",", "9.`", ",", "0.022722296810687`", ",", 
     "0.0000438109607778782`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.04`", ",", "11.`", ",", "0.009773853595364`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.05`", ",", "1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.05`", ",", "3.`", ",", "0.077250043807356`", ",", 
     "1.56573572381499`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.05`", ",", "5.`", ",", "0.058016611003536`", ",", 
     "5.38139381470435`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.05`", ",", "7.`", ",", "0.114960907630491`", ",", 
     "0.0000191158851713459`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.05`", ",", "9.`", ",", "0.068193050369987`", ",", 
     "0.0000805035543037563`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.05`", ",", "11.`", ",", "0.038186202416708`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.06`", ",", "1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06`", ",", "3.`", ",", "0.095387497229636`", ",", 
     "1.45773727181605`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06`", ",", "5.`", ",", "0.065911977260143`", ",", 
     "5.50370927755115`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06`", ",", "7.`", ",", "0.215469854176548`", ",", 
     "0.0000281636782010219`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.06`", ",", "9.`", ",", "0.154267876002591`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.06`", ",", "11.`", ",", "0.10603706669995`", ",", "0.`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.899499507933137*^9, 3.899499782684928*^9, {3.8994998303416348`*^9, 
   3.899499862852442*^9}, 3.8995002518186717`*^9, {3.8995002953668985`*^9, 
   3.8995003010026135`*^9}, 3.8995003776864605`*^9, 3.8995004193394213`*^9, {
   3.899500518245306*^9, 3.899500543359562*^9}},
 CellLabel->
  "Out[231]=",ExpressionUUID->"70e1a41a-bbeb-431d-ba4c-31bffe1bb96f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.01`", ",", "0.01`", ",", "0.01`", ",", "0.01`", ",", "0.01`", ",", 
   "0.01`", ",", "0.02`", ",", "0.02`", ",", "0.02`", ",", "0.02`", ",", 
   "0.02`", ",", "0.02`", ",", "0.03`", ",", "0.03`", ",", "0.03`", ",", 
   "0.03`", ",", "0.03`", ",", "0.03`", ",", "0.04`", ",", "0.04`", ",", 
   "0.04`", ",", "0.04`", ",", "0.04`", ",", "0.04`", ",", "0.05`", ",", 
   "0.05`", ",", "0.05`", ",", "0.05`", ",", "0.05`", ",", "0.05`", ",", 
   "0.06`", ",", "0.06`", ",", "0.06`", ",", "0.06`", ",", "0.06`", ",", 
   "0.06`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.899499507933137*^9, 3.899499782684928*^9, {3.8994998303416348`*^9, 
   3.899499862852442*^9}, 3.8995002518186717`*^9, {3.8995002953668985`*^9, 
   3.8995003010026135`*^9}, 3.8995003776864605`*^9, 3.8995004193394213`*^9, {
   3.899500518245306*^9, 3.8995005433655944`*^9}},
 CellLabel->
  "Out[232]=",ExpressionUUID->"fe2f2507-c5a6-4641-b411-2e700cceec63"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sData", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"2", "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"sData", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}]}]}], "}"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Data", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Around", ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sData", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"2", "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"sData", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "4"}], "]"}], "]"}], "]"}]}]}], "}"}], "]"}], 
     ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DataPlot", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sData", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", "Data"}], "}"}], "]"}],
      ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plot", "=", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"DataPlot", ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<L\>\"", ",", "\"\<I(S;EC)\>\""}], "}"}]}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.9", ",", "11.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.25"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotLegends", "->", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"SwatchLegend", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"sData", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"LegendLabel", "->", "\"\<p\>\""}]}], "]"}], ",", 
         "Automatic"}], "]"}]}]}], "]"}]}], ";", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<file.pdf\>\"", ",", "plot"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.899499762884698*^9, 3.8994998191161423`*^9}, {
  3.899499865127256*^9, 3.899499911509817*^9}, {3.899499950774443*^9, 
  3.8995000061504717`*^9}, {3.8995000396081038`*^9, 3.8995001330164633`*^9}, {
  3.899500177644844*^9, 3.8995001960041943`*^9}, {3.899500310038788*^9, 
  3.8995003155584393`*^9}, {3.8995004324678774`*^9, 3.899500523520559*^9}, {
  3.899500569873144*^9, 3.899500675386175*^9}, {3.899500739596388*^9, 
  3.8995007397252245`*^9}, {3.899502299975029*^9, 3.899502391450277*^9}, {
  3.89950246846173*^9, 3.8995025260142064`*^9}, {3.8995026383045387`*^9, 
  3.899502656081241*^9}, {3.899502697555132*^9, 3.8995026977022905`*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"c237f56b-f700-4a95-8300-8365f5f13045"],

Cell[BoxData["\<\"file.pdf\"\>"], "Output",
 CellChangeTimes->{
  3.8995004464180765`*^9, {3.8995004781230283`*^9, 3.89950052765058*^9}, {
   3.899500571895456*^9, 3.899500584298912*^9}, {3.899500646502469*^9, 
   3.899500675733305*^9}, 3.89950074048538*^9, {3.8995023815399504`*^9, 
   3.899502391720847*^9}, {3.899502473491863*^9, 3.899502526762806*^9}, 
   3.8995026563898177`*^9, 3.899502700234126*^9},
 CellLabel->
  "Out[307]=",ExpressionUUID->"a4a2e17e-3f8a-4eaa-8285-fabb5d0d8192"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8994995136069765`*^9, 3.899499514273257*^9}, 
   3.8994995577632265`*^9, 
   3.899502671961523*^9},ExpressionUUID->"4bb12669-8a2f-4e0a-843f-\
a0a2890a9cbe"]
},
WindowSize->{1920, 1012},
WindowMargins->{{-5.5, Automatic}, {Automatic, -5.5}},
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5e3f4bf2-f457-4895-8df6-49d20d0ad000"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1547, 38, 124, "Input",ExpressionUUID->"949e8ed0-f90c-4246-b796-c57945627308"],
Cell[2130, 62, 512, 10, 32, "Output",ExpressionUUID->"b44fd46e-0901-42ed-8aab-c327a1e2245a"],
Cell[2645, 74, 4857, 136, 122, "Output",ExpressionUUID->"70e1a41a-bbeb-431d-ba4c-31bffe1bb96f"],
Cell[7505, 212, 968, 17, 32, "Output",ExpressionUUID->"fe2f2507-c5a6-4641-b411-2e700cceec63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8510, 234, 3049, 80, 143, "Input",ExpressionUUID->"c237f56b-f700-4a95-8300-8365f5f13045"],
Cell[11562, 316, 489, 8, 32, "Output",ExpressionUUID->"a4a2e17e-3f8a-4eaa-8285-fabb5d0d8192"]
}, Open  ]],
Cell[12066, 327, 205, 4, 28, "Input",ExpressionUUID->"4bb12669-8a2f-4e0a-843f-a0a2890a9cbe"]
}
]
*)

